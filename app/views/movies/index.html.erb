<%# 
  This template iterates over the @movies collection and displays each movie's details.
  It is typically used in the movies index view, located at 'app/views/movies/index.html.erb'.
  The view presents a list of movies, each with its image, title, total gross, average stars, and a truncated description.
  At the end, there is a link for administrators to add a new movie.
%>

<% @movies.each do |movie| %>
  <section class="movie">
    <div class="image">
      <%# 
        Display the movie's image.
        - Uses 'image_tag' helper to generate an HTML <img> tag.
        - 'movie.image_file_name' provides the filename of the movie's image.
        - Assumes the image is stored in 'app/assets/images/' or accessible via a URL.
      %>
      <%= image_tag movie.image_file_name %>
    </div>
    <div class="summary">
      <h2>
        <%# 
          Display the movie title as a link to the movie's show page.
          - 'link_to' creates a hyperlink with the movie's title as the link text.
          - Passing 'movie' as the URL generates the path to the movie's show action.
        %>
        <%= link_to(movie.title, movie) %>
      </h2>
      <h3>
        <%# 
          Display the formatted total gross of the movie.
          - 'total_gross(movie)' is a helper method that formats the total gross for display.
          - It may display 'Flop!' if the movie is considered a flop based on business logic.
        %>
        <%= total_gross(movie) %>
      </h3>
      <span class="stars">
        <%# 
          Display the average star rating of the movie.
          - 'average_stars(movie)' is a helper method that calculates and formats the average rating.
          - Shows 'No reviews' if there are no reviews for the movie.
        %>
        <%= average_stars(movie) %>
      </span>
      <p>
        <%# 
          Display a truncated version of the movie's description.
          - Uses 'truncate' helper to shorten the description to 150 characters.
          - 'separator: ' '' ensures truncation occurs at word boundaries to avoid cutting words in half.
        %>
        <%= truncate(movie.description, length: 150, separator: ' ') %>
      </p>
    </div>
  </section>
<% end %>

<section class="admin">
  <%# 
    Link to add a new movie.
    - 'link_to' creates a hyperlink styled as a button.
    - 'new_movie_path' generates the URL for the new movie form.
    - 'class: "button"' applies a CSS class for styling the link as a button.
  %>
  <%= link_to "Add New Movie", new_movie_path, class: "button" %>
</section>
